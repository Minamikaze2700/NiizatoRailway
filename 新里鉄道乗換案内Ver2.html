<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>新里鉄道 乗換案内</title>
<style>
body { font-family: sans-serif; padding: 20px; max-width: 950px; }
.route-line { color: white; padding: 2px 6px; border-radius: 4px; margin: 0 4px; }
select { margin: 0 10px 0 0; padding: 2px; }
button { padding: 2px 6px; }
#result { margin-top: 12px; max-height: 600px; overflow-y: auto; border:1px solid #ccc; padding:6px; }
</style>
</head>
<body>

<h2>新里鉄道 乗換案内</h2>

<label>発路線:
<select id="startLine" onchange="updateStations('start')"></select>
</label>
<label>発駅:
<select id="start"></select>
</label>
<br><br>
<label>着路線:
<select id="goalLine" onchange="updateStations('goal')"></select>
</label>
<label>着駅:
<select id="goal"></select>
</label>
<br><br>
<button onclick="showRoute()">検索</button>

<div id="result"></div>

<script>
// --- 路線と駅 ---
const stationLines = {
"湯の浜線":["豊町","東豊町","清水浜","安田町","南栃原","栃原","宇城","須川","御浜埼公園","御浜","伊坂","垳下","北浜","西新里","新里","河岸","新里海浜公園","湯の浜海岸","湯の浜","七浦","那珂町","宇多野","伊奈崎","鶴宮神社","鶴宮","北鶴宮"],
"燠野線":["湯の浜","新里大学前","綾原","福来","燠野","湯川","温泉口","燠野温泉"],
"新里線":["新里","南新里","田ノ原","北玖川","玖川","中野原"],
"鶴宮線":["鶴宮","南鶴宮","あずさ台","橘町","燠野山口","白枝","燠野","紅葉台","桐山","湊川","彩山親水公園","彩山","蓮華寺","星宮","田ノ原"],
"彩山線":["彩山","彩山口","新里国際スキー場","鷹見台","久我原","浪原","深江","三栗谷","桜川公園","桜川"]
};

const lineColors = {
"湯の浜線":"#07b5f7",
"燠野線":"#fd5062",
"新里線":"#0cab5e",
"鶴宮線":"#feac2c",
"彩山線":"#7dca22"
};

// --- 距離（簡易） ---
const graph = {
"豊町":["東豊町"],"東豊町":["清水浜"],"清水浜":["安田町"],
"安田町":["南栃原"],"南栃原":["栃原"],"栃原":["宇城"],
"宇城":["須川"],"須川":["御浜埼公園"],"御浜埼公園":["御浜"],
"御浜":["伊坂"],"伊坂":["垳下"],"垳下":["北浜"],"北浜":["西新里"],
"西新里":["新里"],"新里":["湯の浜","南新里"],"湯の浜":["新里大学前","七浦"],
"新里大学前":["綾原"],"綾原":["福来"],"福来":["燠野"],
"燠野":["湯川"],"湯川":["温泉口"],"温泉口":["燠野温泉"]
};

// --- 路線判定 ---
function getLine(from,to){
    for(const [line,stations] of Object.entries(stationLines)){
        for(let i=0;i<stations.length-1;i++){
            if((stations[i]===from && stations[i+1]===to)||(stations[i]===to && stations[i+1]===from)) return line;
        }
    }
    return null;
}

// --- 駅選択更新 ---
function updateStations(type){
    const lineSelect=document.getElementById(type+"Line");
    const stationSelect=document.getElementById(type);
    stationSelect.innerHTML="";
    const line=lineSelect.value;
    stationLines[line].forEach(st=>{
        if(line==="燠野線" && ["新里","河岸","新里海浜公園","湯の浜海岸"].includes(st)) return;
        const opt=document.createElement("option");
        opt.value=st;
        opt.text=st;
        stationSelect.appendChild(opt);
    });
}

// --- 初期化 ---
["startLine","goalLine"].forEach(id=>{
    const select=document.getElementById(id);
    Object.keys(stationLines).forEach(line=>{
        const opt=document.createElement("option");
        opt.value=line; opt.text=line;
        select.appendChild(opt);
    });
});
updateStations("start"); updateStations("goal");

// --- 経路探索（簡易幅優先） ---
function bfs(start,goal){
    const queue=[[start,[start]]];
    const visited=new Set();
    while(queue.length>0){
        const [curr,path]=queue.shift();
        if(curr===goal) return path;
        visited.add(curr);
        const nexts=graph[curr]||[];
        for(const n of nexts){
            if(!visited.has(n)) queue.push([n,path.concat([n])]);
        }
    }
    return null;
}

// --- 表示 ---
function showRoute(){
    const start=document.getElementById("start").value;
    const goal=document.getElementById("goal").value;
    if(start===goal){ document.getElementById("result").innerHTML="発駅と着駅が同じです"; return; }

    let path=bfs(start,goal);
    if(!path){ document.getElementById("result").innerHTML="ルートが見つかりません"; return; }

    // 一行表示
    let html="";
    for(let i=0;i<path.length-1;i++){
        html+=path[i]+" <span class='route-line' style='background:"+lineColors[getLine(path[i],path[i+1])]+"'>新里鉄道 "+getLine(path[i],path[i+1])+"</span> ";
    }
    html+=path[path.length-1];
    document.getElementById("result").innerHTML=html;
}
</script>

</body>
</html>
