<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>経路案内</title>
<style>
  body { font-family: sans-serif; padding: 20px; }
  .route-container { display: flex; flex-direction: column; align-items: flex-start; position: relative; }
  .station { display: flex; align-items: center; margin: 8px 0; position: relative; }
  .circle { width: 18px; height: 18px; border-radius: 50%; flex-shrink: 0; margin-right: 8px; position: relative; z-index: 2; }
  .line { position: absolute; left: 8px; top: 18px; width: 2px; background: #888; z-index: 1; }
  .station-name { font-size: 14px; }
  .line-label { font-size: 12px; padding: 2px 6px; border-radius: 4px; color: #fff; display: inline-block; margin-top: 2px; }
  .toggle-btn { margin-left: 8px; font-size: 12px; padding: 2px 4px; cursor: pointer; }
  .sub-station { margin-left: 32px; display: flex; align-items: center; }
  .sub-circle { width: 14px; height: 14px; border-radius: 50%; margin-right: 6px; }
  .sub-name { font-size: 12px; color: #333; }
</style>
</head>
<body>
<h2>経路案内</h2>

<label>発駅: 
  <select id="fromLine"></select>
  <select id="fromStation"></select>
</label>
<br><br>
<label>着駅: 
  <select id="toLine"></select>
  <select id="toStation"></select>
</label>
<br><br>
<button onclick="showRoute()">検索</button>

<div id="routeDisplay" class="route-container"></div>

<script>
// ==== データ（ユーザー指定済みを保持） ====
const stationLines = {
  "湯の浜線":["豊町","東豊町","清水浜","安田町","南栃原","栃原","宇城","須川","御浜埼公園","御浜","伊坂","垳下","北浜","西新里","新里","河岸","新里海浜公園","湯の浜海岸","湯の浜","七浦","那珂町","宇多野","伊奈崎","鶴宮神社","鶴宮","北鶴宮"],
  "燠野線":["湯の浜","新里大学前","綾原","福来","燠野","湯川","温泉口","燠野温泉"],
  "鶴宮線":["鶴宮","南鶴宮","あずさ台","橘町","燠野山口","白枝","燠野","紅葉台","桐山","湊川","彩山親水公園","彩山","蓮華寺","星宮","田ノ原"],
  "新里線":["新里","南新里","田ノ原","北玖川","玖川","中野原"],
  "彩山線":["彩山","彩山口","新里国際スキー場","鷹見台","久我原","浪原","深江","三栗谷","桜川公園","桜川"]
};
const lineColors = {
  "湯の浜線":"#07b5f7",
  "燠野線":"#fd5062",
  "新里線":"#0cab5e",
  "鶴宮線":"#feac2c",
  "彩山線":"#7dca22"
};

// ==== 駅選択初期化 ====
function initSelects(){
  const fromLine = document.getElementById("fromLine");
  const toLine = document.getElementById("toLine");
  for(const line in stationLines){
    [fromLine,toLine].forEach(sel=>{
      const opt = document.createElement("option");
      opt.value=line; opt.text=line;
      sel.appendChild(opt);
    });
  }
  updateStations("fromLine","fromStation");
  updateStations("toLine","toStation");
}
function updateStations(lineSelId,stationSelId){
  const line=document.getElementById(lineSelId).value;
  const stationSel=document.getElementById(stationSelId);
  stationSel.innerHTML="";
  stationLines[line].forEach(st=>{
    const opt=document.createElement("option");
    opt.value=st; opt.text=st;
    stationSel.appendChild(opt);
  });
}
document.getElementById("fromLine").onchange=()=>updateStations("fromLine","fromStation");
document.getElementById("toLine").onchange=()=>updateStations("toLine","toStation");
initSelects();

// ==== 経路描画（簡略: 同一線内のみ対応） ====
function showRoute(){
  const from=document.getElementById("fromStation").value;
  const to=document.getElementById("toStation").value;
  const fromLine=document.getElementById("fromLine").value;
  const toLine=document.getElementById("toLine").value;
  const display=document.getElementById("routeDisplay");
  display.innerHTML="";

  if(fromLine!==toLine){ display.innerHTML="※ 今は同一線内のみ対応"; return; }

  const line=fromLine;
  const color=lineColors[line];
  const list=stationLines[line];
  const i1=list.indexOf(from), i2=list.indexOf(to);
  if(i1===-1||i2===-1){ display.innerHTML="駅が見つかりません"; return; }

  const path=i1<i2?list.slice(i1,i2+1):list.slice(i2,i1+1).reverse();

  for(let i=0;i<path.length;i++){
    const st=path[i];
    const isFirst=i===0, isLast=i===path.length-1;
    const stationDiv=document.createElement("div");
    stationDiv.className="station";

    const circle=document.createElement("div");
    circle.className="circle";
    circle.style.background=color;
    stationDiv.appendChild(circle);

    const nameDiv=document.createElement("div");
    if(isFirst){ // 発駅
      nameDiv.innerHTML=`${st}<br><span class="line-label" style="background:${color}">新里鉄道${line}</span>`;
      const btn=document.createElement("button");
      btn.className="toggle-btn";
      btn.textContent="途中駅表示";
      btn.onclick=()=>toggleSubs(st,path.slice(1,-1),color,stationDiv);
      stationDiv.appendChild(nameDiv);
      stationDiv.appendChild(btn);
    }else if(isLast){ // 着駅
      nameDiv.textContent=st;
      stationDiv.appendChild(nameDiv);
    }else{
      // デフォルト非表示
      stationDiv.style.display="none";
    }

    display.appendChild(stationDiv);

    // 線
    if(i<path.length-1){
      const lineDiv=document.createElement("div");
      lineDiv.className="line";
      lineDiv.style.height="30px";
      lineDiv.style.background=color;
      stationDiv.appendChild(lineDiv);
    }
  }
}

function toggleSubs(start,subs,color,parent){
  subs.forEach(st=>{
    const sub=document.createElement("div");
    sub.className="sub-station";
    const c=document.createElement("div");
    c.className="sub-circle";
    c.style.background=color;
    sub.appendChild(c);
    const nm=document.createElement("div");
    nm.className="sub-name";
    nm.textContent=st;
    sub.appendChild(nm);
    parent.after(sub);
  });
}
</script>
</body>
</html>
