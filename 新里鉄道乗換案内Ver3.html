<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>乗換案内</title>
<style>
  body { font-family: sans-serif; margin: 20px; }

  .selector { margin-bottom: 10px; }

  /* 路線色ラベル */
  .line-label {
    display: inline-block;
    padding: 2px 6px;
    color: #fff;
    border-radius: 4px;
    font-size: 0.9em;
    margin-left: 5px;
  }

  /* 経路表示 */
  .route {
    margin-top: 20px;
  }
  .station-block {
    display: flex;
    align-items: center;
  }
  .circle {
    width: 14px;
    height: 14px;
    background: black;
    border-radius: 50%;
    margin-right: 6px;
    flex-shrink: 0;
  }
  .small-circle {
    width: 10px;
    height: 10px;
    background: black;
    border-radius: 50%;
    margin: 0 auto;
  }
  .line {
    width: 2px;
    background: black;
    margin: 0 6px;
    flex-shrink: 0;
  }
  .station-name {
    font-weight: bold;
  }
  .toggle-link {
    margin-left: 10px;
    font-size: 0.85em;
    color: blue;
    cursor: pointer;
  }
</style>
</head>
<body>
  <h2>乗換案内</h2>

  <!-- プルダウン -->
  <div class="selector">
    <select id="fromLine"></select>
    <select id="fromStation"></select>
  </div>
  <div class="selector">
    <select id="toLine"></select>
    <select id="toStation"></select>
  </div>

  <!-- 経路描画 -->
  <div id="route" class="route"></div>

<script>
const lines = {
  "新里鉄道本線": {
    color: "#07b5f7",
    stations: ["田ノ原", "栃原", "新町", "西原", "中央"]
  },
  "新里鉄道東線": {
    color: "#f78c07",
    stations: ["中央", "東町", "緑丘", "東原"]
  }
};

function populateSelects() {
  const fromLine = document.getElementById("fromLine");
  const fromStation = document.getElementById("fromStation");
  const toLine = document.getElementById("toLine");
  const toStation = document.getElementById("toStation");

  for (let line in lines) {
    let opt1 = new Option(line, line);
    let opt2 = new Option(line, line);
    fromLine.add(opt1);
    toLine.add(opt2);
  }

  fromLine.onchange = () => {
    fromStation.innerHTML = "";
    lines[fromLine.value].stations.forEach(s => fromStation.add(new Option(s, s)));
  };
  toLine.onchange = () => {
    toStation.innerHTML = "";
    lines[toLine.value].stations.forEach(s => toStation.add(new Option(s, s)));
  };

  fromLine.dispatchEvent(new Event("change"));
  toLine.dispatchEvent(new Event("change"));
}

function drawRoute() {
  const routeDiv = document.getElementById("route");
  routeDiv.innerHTML = "";

  const fromLine = document.getElementById("fromLine").value;
  const fromStation = document.getElementById("fromStation").value;
  const toLine = document.getElementById("toLine").value;
  const toStation = document.getElementById("toStation").value;

  const path = [
    {station: fromStation, line: fromLine, major: true},
    {station: "栃原", line: fromLine, major: true}, // ダミーの主要駅
    {station: toStation, line: toLine, major: true}
  ];

  path.forEach((stop, idx) => {
    // 駅
    const row = document.createElement("div");
    row.className = "station-block";
    const circle = document.createElement("div");
    circle.className = stop.major ? "circle" : "small-circle";
    row.appendChild(circle);
    const name = document.createElement("div");
    name.className = "station-name";
    name.textContent = stop.station;
    row.appendChild(name);
    routeDiv.appendChild(row);

    // 線とラベル（最後以外）
    if (idx < path.length - 1) {
      const lineDiv = document.createElement("div");
      lineDiv.style.display = "flex";
      lineDiv.style.alignItems = "center";

      const lineBar = document.createElement("div");
      lineBar.className = "line";
      lineBar.style.background = lines[stop.line].color;
      lineBar.style.height = "30px";
      lineDiv.appendChild(lineBar);

      const label = document.createElement("span");
      label.className = "line-label";
      label.style.background = lines[stop.line].color;
      label.textContent = stop.line;
      lineDiv.appendChild(label);

      const toggle = document.createElement("span");
      toggle.className = "toggle-link";
      toggle.textContent = "途中駅を表示";
      lineDiv.appendChild(toggle);

      routeDiv.appendChild(lineDiv);
    }
  });
}

populateSelects();
document.getElementById("fromStation").onchange = drawRoute;
document.getElementById("toStation").onchange = drawRoute;
drawRoute();
</script>
</body>
</html>
