<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Railway Route Map</title>
<style>
  body { font-family: sans-serif; }
  #map { display: flex; justify-content: center; margin: 20px; }
  .line { display: flex; flex-direction: column; align-items: center; }
  .station {
    display: flex;
    align-items: center;
    margin: 6px 0;
    position: relative;
  }
  .station-circle {
    width: 14px; height: 14px;
    border-radius: 50%;
    margin: 0 auto;
    flex-shrink: 0;
  }
  .station-circle.small { 
    width: 10px; height: 10px; 
    display: none; /* デフォルト非表示 */
  }
  .station-name {
    margin-left: 8px;
    white-space: nowrap;
  }
  .station-line-name {
    font-size: 0.8em;
    margin-top: 2px;
    padding: 1px 4px;
    border-radius: 4px;
    color: white;
    display: inline-block;
  }
  .line-segment {
    width: 4px;
    flex-grow: 1;
  }
  .station-label {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    margin-left: 8px;
  }
</style>
</head>
<body>
<h2>路線図と運賃計算</h2>
<div id="map"></div>
<button onclick="toggleStops()">停車駅表示切替</button>

<script>
// ==== 駅・路線データ ====
const stationLines = {
  "湯の浜線": [
    "豊町","東豊町","清水浜","安田町","南栃原","栃原","宇城","須川","御浜埼公園","御浜","伊坂","垳下","北浜","西新里","新里","河岸","新里海浜公園","湯の浜海岸","湯の浜","七浦","那珂町","宇多野","伊奈崎","鶴宮神社","鶴宮","北鶴宮"
  ],
  "燠野線": ["湯の浜","新里大学前","綾原","福来","燠野","湯川","温泉口","燠野温泉"],
  "鶴宮線": ["鶴宮","南鶴宮","あずさ台","橘町","燠野山口","白枝","燠野","紅葉台","桐山","湊川","彩山親水公園","彩山","蓮華寺","星宮","田ノ原"],
  "新里線": ["新里","南新里","田ノ原","北玖川","玖川","中野原"],
  "彩山線": ["彩山","彩山口","新里国際スキー場","鷹見台","久我原","浪原","深江","三栗谷","桜川公園","桜川"]
};

const lineColors = {
  "湯の浜線": "#07b5f7",
  "燠野線": "#fd5062",
  "新里線": "#0cab5e",
  "鶴宮線": "#feac2c",
  "彩山線": "#7dca22"
};

// ==== 駅間距離データ ====
const rawGraph = {
  "豊町":{"東豊町":1.2}, "東豊町":{"清水浜":1.4}, "清水浜":{"安田町":1.9}, "安田町":{"南栃原":2.2},
  "南栃原":{"栃原":0.9}, "栃原":{"宇城":2.2}, "宇城":{"須川":2.1}, "須川":{"御浜埼公園":1.9},
  "御浜埼公園":{"御浜":0.6}, "御浜":{"伊坂":2.5}, "伊坂":{"垳下":2.6}, "垳下":{"北浜":2.3},
  "北浜":{"西新里":1.4}, "西新里":{"新里":1.7}, "新里":{"河岸":0.9,"南新里":2.5}, "河岸":{"新里海浜公園":1.7},
  "新里海浜公園":{"湯の浜海岸":2.3}, "湯の浜海岸":{"湯の浜":1.5}, "湯の浜":{"七浦":2.5,"新里大学前":0.8},
  "七浦":{"那珂町":1.6}, "那珂町":{"宇多野":2.2}, "宇多野":{"伊奈崎":1.8}, "伊奈崎":{"鶴宮神社":1.5},
  "鶴宮神社":{"鶴宮":1.2}, "鶴宮":{"南鶴宮":1.4,"鶴宮神社":1.2}, "南鶴宮":{"あずさ台":1.5},
  "あずさ台":{"橘町":2.2}, "橘町":{"燠野山口":2.0}, "燠野山口":{"白枝":1.6}, "白枝":{"燠野":1.3},
  "燠野":{"湯川":1.2,"紅葉台":1.7}, "湯川":{"温泉口":2.1}, "温泉口":{"燠野温泉":1.6},
  "紅葉台":{"桐山":1.9}, "桐山":{"湊川":2.5}, "湊川":{"彩山親水公園":1.2}, "彩山親水公園":{"彩山":0.8},
  "彩山":{"蓮華寺":1.6,"彩山口":2.2}, "蓮華寺":{"星宮":2.0}, "星宮":{"田ノ原":2.4}, "田ノ原":{"北玖川":2.3},
  "北玖川":{"玖川":1.9}, "玖川":{"中野原":2.7}, "彩山口":{"新里国際スキー場":1.8}, "新里国際スキー場":{"鷹見台":2.0},
  "鷹見台":{"久我原":1.9}, "久我原":{"浪原":2.5}, "浪原":{"深江":2.4}, "深江":{"三栗谷":2.7},
  "三栗谷":{"桜川公園":1.6}, "桜川公園":{"桜川":1.0}
};

// ==== 運賃計算 ====
function fare(distance){
  if(distance<=3) return {adult:130,child:70};
  else if(distance<=6) return {adult:160,child:80};
  else if(distance<=10) return {adult:190,child:100};
  else if(distance<=15) return {adult:220,child:110};
  else if(distance<=20) return {adult:250,child:130};
  else if(distance<=25) return {adult:280,child:140};
  else if(distance<=30) return {adult:310,child:160};
  else return {adult:340,child:170};
}

// ==== 路線図生成 ====
function drawMap(){
  const map = document.getElementById("map");
  map.innerHTML = "";
  for(const [line,stations] of Object.entries(stationLines)){
    const div = document.createElement("div");
    div.className = "line";
    stations.forEach((st,i)=>{
      const stationDiv = document.createElement("div");
      stationDiv.className = "station";

      // ●
      const circle = document.createElement("div");
      circle.className = "station-circle";
      circle.style.background = lineColors[line];

      const circleSmall = document.createElement("div");
      circleSmall.className = "station-circle small";
      circleSmall.style.background = lineColors[line];
      circleSmall.dataset.hiddenStop = "true";

      // ラベル（駅名＋路線名）
      const label = document.createElement("div");
      label.className = "station-label";
      const name = document.createElement("div");
      name.className = "station-name";
      name.textContent = st;
      label.appendChild(name);

      // 発駅・乗換駅 → 路線名を背景カラー付きで改行表示
      if(Object.values(stationLines).filter(l=>l.includes(st)).length > 1){
        for(const ln of Object.keys(stationLines)){
          if(stationLines[ln].includes(st)){
            const lnDiv = document.createElement("div");
            lnDiv.className = "station-line-name";
            lnDiv.style.background = lineColors[ln];
            lnDiv.textContent = "新里鉄道 " + ln;
            label.appendChild(lnDiv);
          }
        }
      }

      stationDiv.appendChild(circle);
      stationDiv.appendChild(circleSmall);
      stationDiv.appendChild(label);
      div.appendChild(stationDiv);

      // 線
      if(i < stations.length-1){
        const seg = document.createElement("div");
        seg.className = "line-segment";
        seg.style.background = lineColors[line];
        div.appendChild(seg);
      }
    });
    map.appendChild(div);
  }
}
drawMap();

// ==== 停車駅表示切替 ====
function toggleStops(){
  document.querySelectorAll(".station-circle.small").forEach(s=>{
    if(s.style.display==="none") s.style.display="block";
    else s.style.display="none";
  });
}
</script>
</body>
</html>
