<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>新里地方 乗換案内</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
:root{
  --bg:#f1f5f9;
  --card:#fff;
  --muted:#667085;
  --radius:12px;
  --gutter:34px;
  --dotMajor:16px;
  --dotMinor:12px;
  --lineWMajor:5px;
  --lineWMinor:5px;
  --font-sans:"Hiragino Kaku Gothic ProN","Meiryo",system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans JP",sans-serif;
}
html,body{height:100%;margin:0;font-family:var(--font-sans);background:var(--bg);color:#0b1324}
.wrap{max-width:980px;margin:28px auto;padding:20px}
h1{margin:0 0 12px;font-size:20px}
.card{background:var(--card);border-radius:var(--radius);padding:16px;box-shadow:0 8px 24px rgba(2,6,23,0.07);margin-bottom:12px}
.row{display:flex;gap:12px;align-items:flex-start;flex-direction:column}
.col{display:flex;flex-direction:column;gap:6px;position:relative;align-items:flex-start}
select,button{font-size:14px;padding:8px 10px;border-radius:4px;border:1px solid #d1d5db;background:#fff}
label{font-size:13px;color:var(--muted)}
button.primary{cursor:pointer;background:#0b5fff;color:#fff;border:none}
.resultHeader{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
.resultHeader .meta{display:flex;gap:18px;color:#111}
.routeLine{display:flex;flex-direction:column;gap:10px;margin-top:4px}
.rowStation{display:grid;grid-template-columns:var(--gutter) 1fr;align-items:start;column-gap:10px;position:relative;}
.railCol{display:flex;flex-direction:column;align-items:center;position:relative;}
.railDot{border-radius:50%;width:var(--dotMajor);height:var(--dotMajor);z-index:2;border:2px solid #fff;position:absolute;left:50%;top:0;transform:translateX(-50%);box-sizing:content-box;}
.rowBetween .railDot{width:var(--dotMinor);height:var(--dotMinor);border:2px solid #fff;position:absolute;left:50%;top:0;transform:translateX(-50%);z-index:2;}
.railLineMajor{width:var(--lineWMajor);border-radius:2px;position:absolute;left:50%;transform:translateX(-50%);z-index:1;top:0;height:0;background:#999;}
.railLineMinor{width:var(--lineWMinor);border-radius:1px;position:absolute;left:50%;transform:translateX(-50%);z-index:1;top:0;height:0;background:#999;}
.stationText{display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start}
.stationName{font-weight:700;font-size:16px;line-height:1.25;margin:0}
.lineBadge{display:inline-block;color:#fff;font-size:13.5px;line-height:1;padding:2px 6px;border-radius:6px;margin-top:6px;white-space:nowrap}
.toggleWrap{margin-top:6px}
.toggleBtn{cursor:pointer;padding:4px 8px;font-size:12px}
.rowBetween{display:grid;grid-template-columns:var(--gutter) 1fr;column-gap:10px;align-items:start;height:auto;padding-top:12px;}
.rowBetween .stationText{display:flex;align-items:flex-start;padding-top:0;}
.minorName{font-size:14px;font-weight:400;margin:0;position:relative;top:-4px}
.rowBetween .railLineMinor{height:48px;}
.betweenList{ display:none; }
.spacer4{height:4px}
.spacer6{height:6px}
.viaList{display:flex;flex-direction:column;gap:6px;margin:6px 0;align-items:flex-start}
.viaRow{display:flex;align-items:center;gap:6px;justify-content:flex-start}
.viaRow button{font-size:12px;padding:4px 6px}
</style>
</head>
<body>
<div class="wrap">
<h1>新里地方 乗換案内</h1>
<div class="card">
  <div id="stationSelector">
    <div class="row">
      <div class="col">
        <label>発駅</label>
        <div style="display:flex;gap:6px">
          <select class="lineSelect" id="fromLine"></select>
          <select class="stationSelect" id="fromStation"></select>
        </div>
      </div>
      <div class="col">
        <label>経由地</label>
        <div class="viaList" id="viaList"></div>
        <button id="addViaBtn" class="primary">経由地を追加</button>
      </div>
      <div class="col">
        <label>着駅</label>
        <div style="display:flex;gap:6px">
          <select class="lineSelect" id="toLine"></select>
          <select class="stationSelect" id="toStation"></select>
        </div>
      </div>
      <div style="display:flex;align-items:flex-end;">
        <button id="searchBtn" class="primary">検索</button>
      </div>
    </div>
  </div>
</div>
<div id="resultArea"></div>
</div>

<script>
// ==== データ ====
const stationLines = {
 "新里鉄道湯の浜線":["豊町","東豊町","清水浜","安田町","南栃原","栃原","宇城","須川","御浜埼公園","御浜","伊坂","垳下","北浜","西新里","新里","河岸","新里海浜公園","湯の浜海岸","湯の浜","七浦","那珂町","宇多野","伊奈崎","鶴宮神社","鶴宮","北鶴宮"],
 "新里鉄道燠野線":["湯の浜","新里大学前","綾原","福来","燠野","湯川","温泉口","燠野温泉"],
 "新里鉄道鶴宮線":["鶴宮","南鶴宮","あずさ台","橘町","燠野山口","白枝","燠野","紅葉台","桐山","湊川","彩山親水公園","彩山","蓮華寺","星宮","田ノ原"],
 "新里鉄道新里線":["新里","南新里","田ノ原","北玖川","玖川","中野原"],
 "新里鉄道彩山線":["彩山","彩山口","新里国際スキー場","鷹見台","久我原","浪原","深江","三栗谷","桜川公園","桜川"],
 "鈴浜電気鉄道鈴浜電鉄線":["桜川国際空港","りんくう桜川","余田","白砂","千種園","大三浜","外神","紅葉台","恋野宮","南河都","河都","北河都","百合ヶ山公園","猫崎海岸","籾井","白木稲荷","流沢温泉口","流沢温泉","北鶴宮"]
};

const lineColors = {
  "新里鉄道湯の浜線":"#00bfff",
  "新里鉄道燠野線":"#ff4d6d",
  "新里鉄道鶴宮線":"#ffa500",
  "新里鉄道新里線":"#228b22",
  "新里鉄道彩山線":"#32cd32",
  "鈴浜電気鉄道鈴浜電鉄線":"#0c9451"
};

// ==== 駅間距離 rawGraph ====
const rawGraph = {
"豊町":{"東豊町":1.2},
"東豊町":{"清水浜":1.5},
"清水浜":{"安田町":1.1},
"安田町":{"南栃原":0.9},
"南栃原":{"栃原":1.0},
"栃原":{"宇城":0.8},
"宇城":{"須川":1.2},
"須川":{"御浜埼公園":1.5},
"御浜埼公園":{"御浜":1.1},
"御浜":{"伊坂":1.0},
"伊坂":{"垳下":0.9},
"垳下":{"北浜":1.2},
"北浜":{"西新里":1.3},
"西新里":{"新里":1.1},
"新里":{"河岸":0.8,"南新里":1.0},
"河岸":{"新里海浜公園":1.5},
"新里海浜公園":{"湯の浜海岸":1.0},
"湯の浜海岸":{"湯の浜":1.2},
"湯の浜":{"七浦":1.1,"新里大学前":2.0},
"七浦":{"那珂町":0.9},
"那珂町":{"宇多野":1.1},
"宇多野":{"伊奈崎":0.8},
"伊奈崎":{"鶴宮神社":1.2},
"鶴宮神社":{"鶴宮":1.0},
"鶴宮":{"北鶴宮":1.3,"南鶴宮":0.9,"紅葉台":1.4},
"北鶴宮":{},
"南鶴宮":{"あずさ台":1.0},
"あずさ台":{"橘町":1.2},
"橘町":{"燠野山口":1.1},
"燠野山口":{"白枝":1.0},
"白枝":{"燠野":1.2},
"燠野":{"紅葉台":1.3,"湯川":1.0},
"紅葉台":{"桐山":1.1},
"桐山":{"湊川":1.3},
"湊川":{"彩山親水公園":1.2},
"彩山親水公園":{"彩山":0.9},
"彩山":{"蓮華寺":1.0,"彩山口":1.1},
"蓮華寺":{"星宮":1.2},
"星宮":{"田ノ原":1.3},
"田ノ原":{"北玖川":1.2},
"北玖川":{"玖川":1.1},
"玖川":{"中野原":1.3},
"中野原":{},
"彩山口":{"新里国際スキー場":1.2},
"新里国際スキー場":{"鷹見台":1.1},
"鷹見台":{"久我原":1.3},
"久我原":{"浪原":1.2},
"浪原":{"深江":1.1},
"深江":{"三栗谷":1.3},
"三栗谷":{"桜川公園":1.2},
"桜川公園":{"桜川":1.1},
"桜川":{},
"桜川国際空港":{"りんくう桜川":1.1},
"りんくう桜川":{"余田":2.3},
"余田":{"白砂":1.5},
"白砂":{"千種園":1.2},
"千種園":{"大三浜":1.0},
"大三浜":{"外神":1.4},
"外神":{"紅葉台":1.2},
"恋野宮":{"南河都":1.1},
"南河都":{"河都":1.3},
"河都":{"北河都":1.2},
"北河都":{"百合ヶ山公園":1.0},
"百合ヶ山公園":{"猫崎海岸":1.3},
"猫崎海岸":{"籾井":1.2},
"籾井":{"白木稲荷":1.1},
"白木稲荷":{"流沢温泉口":1.3},
"流沢温泉口":{"流沢温泉":1.2},
"流沢温泉":{"北鶴宮":1.1}
};

// ==== グラフ構築 ====
function buildGraphBidirectional(raw){
  const g = {};
  for(const [a,edges] of Object.entries(raw)){
    if(!g[a]) g[a]={};
    for(const [b,d] of Object.entries(edges)){
      g[a][b]=d;
      if(!g[b]) g[b]={};
      if(g[b][a]==null) g[b][a]=d;
    }
  }
  return g;
}
const graph = buildGraphBidirectional(rawGraph);
const allStations = Array.from(new Set([...Object.keys(graph), ...Object.values(graph).flatMap(x => Object.keys(x))])).sort();

// ==== UI初期化 ====
const fromLineSel = document.getElementById('fromLine');
const toLineSel = document.getElementById('toLine');
const fromStationSel = document.getElementById('fromStation');
const toStationSel = document.getElementById('toStation');
const viaList = document.getElementById('viaList');

function populateLineSelect(select){
  select.innerHTML='';
  for(const line of Object.keys(stationLines)){
    const opt = document.createElement('option');
    opt.value=line;
    opt.textContent=line;
    select.appendChild(opt);
  }
}

function populateStationSelect(line, stationSelect){
  stationSelect.innerHTML='';
  const stations = stationLines[line]||[];
  for(const st of stations){
    const opt = document.createElement('option');
    opt.value=st;
    opt.textContent=st;
    stationSelect.appendChild(opt);
  }
}

// 初期化
populateLineSelect(fromLineSel);
populateLineSelect(toLineSel);
populateStationSelect(fromLineSel.value, fromStationSel);
populateStationSelect(toLineSel.value, toStationSel);

// 行き先変更時に駅更新
fromLineSel.addEventListener('change',()=>populateStationSelect(fromLineSel.value,fromStationSel));
toLineSel.addEventListener('change',()=>populateStationSelect(toLineSel.value,toStationSel));

// ==== 経由地追加 ====
document.getElementById('addViaBtn').addEventListener('click',()=>{
  const row = document.createElement('div');
  row.className='viaRow';

  const lineSel = document.createElement('select');
  populateLineSelect(lineSel);

  const stationSel = document.createElement('select');
  populateStationSelect(lineSel.value, stationSel);

  lineSel.addEventListener('change',()=>populateStationSelect(lineSel.value, stationSel));

  const delBtn = document.createElement('button');
  delBtn.textContent='削除';
  delBtn.addEventListener('click',()=>viaList.removeChild(row));

  row.appendChild(lineSel);
  row.appendChild(stationSel);
  row.appendChild(delBtn);
  viaList.appendChild(row);
});

// ==== 検索ボタン ====
document.getElementById('searchBtn').addEventListener('click',()=>{
  const from = fromStationSel.value;
  const to = toStationSel.value;
  const vias = Array.from(viaList.querySelectorAll('select.stationSelect')).map(s=>s.value);
  console.log('検索:',from,to,vias);
  const resultArea = document.getElementById('resultArea');
  resultArea.innerHTML=`<div class="card">出発: ${from} <br>経由: ${vias.join(', ')} <br>到着: ${to}</div>`;
});
</script>
</body>
</html>
