<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>路線図と運賃案内</title>
  <style>
    body { font-family: sans-serif; }
    .station { margin: 5px 0; }
    .line-name { color: #fff; padding: 2px 6px; border-radius: 4px; display: inline-block; margin: 4px 0; }
    .toggle { color: blue; cursor: pointer; text-decoration: underline; margin-left: 1em; }
    .substation { margin-left: 2em; }
  </style>
</head>
<body>
  <h2>発駅・着駅を選択</h2>
  <div>
    発駅：
    <select id="fromLine"></select>
    <select id="fromStation"></select>
  </div>
  <div>
    着駅：
    <select id="toLine"></select>
    <select id="toStation"></select>
  </div>

  <h2>路線図</h2>
  <div id="routeDisplay"></div>

  <script>
    // ==== 駅・路線データ ====
    const stationLines = {
      "湯の浜線":["豊町","東豊町","清水浜","安田町","南栃原","栃原","宇城","須川","御浜埼公園","御浜","伊坂","垳下","北浜","西新里","新里","河岸","新里海浜公園","湯の浜海岸","湯の浜","七浦","那珂町","宇多野","伊奈崎","鶴宮神社","鶴宮","北鶴宮"],
      "燠野線":["湯の浜","新里大学前","綾原","福来","燠野","湯川","温泉口","燠野温泉"],
      "鶴宮線":["鶴宮","南鶴宮","あずさ台","橘町","燠野山口","白枝","燠野","紅葉台","桐山","湊川","彩山親水公園","彩山","蓮華寺","星宮","田ノ原"],
      "新里線":["新里","南新里","田ノ原","北玖川","玖川","中野原"],
      "彩山線":["彩山","彩山口","新里国際スキー場","鷹見台","久我原","浪原","深江","三栗谷","桜川公園","桜川"]
    };
    const lineColors = {
      "湯の浜線":"#07b5f7",
      "燠野線":"#fd5062",
      "新里線":"#0cab5e",
      "鶴宮線":"#feac2c",
      "彩山線":"#7dca22"
    };

    // ==== 駅間距離データ ====
    const rawGraph = {
      "豊町":{"東豊町":1.2}, "東豊町":{"清水浜":1.4}, "清水浜":{"安田町":1.9}, "安田町":{"南栃原":2.2},
      "南栃原":{"栃原":0.9}, "栃原":{"宇城":2.2}, "宇城":{"須川":2.1}, "須川":{"御浜埼公園":1.9},
      "御浜埼公園":{"御浜":0.6}, "御浜":{"伊坂":2.5}, "伊坂":{"垳下":2.6}, "垳下":{"北浜":2.3},
      "北浜":{"西新里":1.4}, "西新里":{"新里":1.7}, "新里":{"河岸":0.9,"南新里":2.5},
      "河岸":{"新里海浜公園":1.7}, "新里海浜公園":{"湯の浜海岸":2.3}, "湯の浜海岸":{"湯の浜":1.5},
      "湯の浜":{"七浦":2.5,"新里大学前":0.8}, "七浦":{"那珂町":1.6}, "那珂町":{"宇多野":2.2},
      "宇多野":{"伊奈崎":1.8}, "伊奈崎":{"鶴宮神社":1.5}, "鶴宮神社":{"鶴宮":1.2}, "鶴宮":{"北鶴宮":1.1,"南鶴宮":1.7},
      "新里大学前":{"綾原":0.7}, "綾原":{"福来":1.2}, "福来":{"燠野":1.4}, "燠野":{"湯川":2.6,"紅葉台":1.1},
      "湯川":{"温泉口":1.6}, "温泉口":{"燠野温泉":1.9}, "南鶴宮":{"あずさ台":1.4}, "あずさ台":{"橘町":1.8},
      "橘町":{"燠野山口":1.1}, "燠野山口":{"白枝":1.2}, "白枝":{"燠野":1.1}, "紅葉台":{"桐山":0.8},
      "桐山":{"湊川":0.8}, "湊川":{"彩山親水公園":1.1}, "彩山親水公園":{"彩山":1.2}, "彩山":{"蓮華寺":0.8,"彩山口":2.1},
      "蓮華寺":{"星宮":1.1}, "星宮":{"田ノ原":1.1}, "南新里":{"田ノ原":2.3}, "田ノ原":{"北玖川":2.4},
      "北玖川":{"玖川":3.1}, "玖川":{"中野原":3.1}, "彩山口":{"新里国際スキー場":3.4},
      "新里国際スキー場":{"鷹見台":10.7}, "鷹見台":{"久我原":2.7}, "久我原":{"浪原":1.5},
      "浪原":{"深江":1.4}, "深江":{"三栗谷":1.3}, "三栗谷":{"桜川公園":1.5}, "桜川公園":{"桜川":2.2}
    };
    const graph = {};
    for (const [from, targets] of Object.entries(rawGraph)) {
      if (!graph[from]) graph[from] = {};
      for (const [to, d] of Object.entries(targets)) {
        graph[from][to] = d;
        if (!graph[to]) graph[to] = {};
        graph[to][from] = d;
      }
    }

    // ==== 運賃 ====
    function fare(distance){
      if(distance<=3) return {adult:130,child:70};
      else if(distance<=6) return {adult:160,child:80};
      else if(distance<=10) return {adult:190,child:100};
      else if(distance<=15) return {adult:220,child:110};
      else if(distance<=20) return {adult:250,child:130};
      else if(distance<=25) return {adult:280,child:140};
      else if(distance<=30) return {adult:310,child:160};
      else return {adult:340,child:170};
    }

    // ==== プルダウン初期化 ====
    function initDropdowns(){
      const fromLine = document.getElementById("fromLine");
      const toLine = document.getElementById("toLine");
      fromLine.innerHTML = toLine.innerHTML = Object.keys(stationLines).map(l=>`<option>${l}</option>`).join("");
      updateStations("fromLine","fromStation");
      updateStations("toLine","toStation");
      fromLine.addEventListener("change",()=>updateStations("fromLine","fromStation"));
      toLine.addEventListener("change",()=>updateStations("toLine","toStation"));
    }
    function updateStations(lineId,stationId){
      const line = document.getElementById(lineId).value;
      const select = document.getElementById(stationId);
      select.innerHTML = stationLines[line].map(s=>`<option>${s}</option>`).join("");
    }

    // ==== 路線図描画 ====
    function renderRoutes(){
      const container = document.getElementById("routeDisplay");
      container.innerHTML = "";
      for(const [line, stations] of Object.entries(stationLines)){
        const lineDiv = document.createElement("div");
        lineDiv.innerHTML = `<div class='station'>●${stations[0]}（主要）</div>`;
        lineDiv.innerHTML += `<div class='line-name' style='background:${lineColors[line]}'>${line}</div>`;
        const toggle = document.createElement("div");
        toggle.className = "toggle";
        toggle.textContent = "途中駅を表示";
        let expanded = false;
        toggle.addEventListener("click",()=>{
          expanded=!expanded;
          if(expanded){
            toggle.textContent="途中駅を非表示";
            let subs="";
            for(let i=1;i<stations.length-1;i++){
              subs+=`<div class='station substation'>●${stations[i]}（途中）</div>`;
            }
            subs+=`<div class='station'>●${stations[stations.length-1]}（終着）</div>`;
            toggle.insertAdjacentHTML("afterend",subs);
          }else{
            toggle.textContent="途中駅を表示";
            while(toggle.nextSibling && toggle.nextSibling.classList.contains("station")){
              toggle.nextSibling.remove();
            }
          }
        });
        lineDiv.appendChild(toggle);
        container.appendChild(lineDiv);
      }
    }

    initDropdowns();
    renderRoutes();
  </script>
</body>
</html>
