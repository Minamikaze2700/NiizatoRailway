import React, { useState } from "react";

// 全駅と距離データ（省略なし）
const stationDistances = {
  "豊町": { "東豊町": 1.2 },
  "東豊町": { "清水浜": 1.4 },
  "清水浜": { "安田町": 1.9 },
  "安田町": { "南栃原": 2.2 },
  "南栃原": { "栃原": 0.9 },
  "栃原": { "宇城": 2.2 },
  "宇城": { "須川": 2.1 },
  "須川": { "御浜埼公園": 1.9 },
  "御浜埼公園": { "御浜": 0.6 },
  "御浜": { "伊坂": 2.5 },
  "伊坂": { "垳下": 2.6 },
  "垳下": { "北浜": 2.3 },
  "北浜": { "西新里": 1.4 },
  "西新里": { "新里": 1.7 },
  "新里": { "河岸": 0.9, "南新里": 2.5 },
  "河岸": { "新里海浜公園": 1.7 },
  "新里海浜公園": { "湯の浜海岸": 2.3 },
  "湯の浜海岸": { "湯の浜": 1.5 },
  "湯の浜": { "七浦": 2.5, "新里大学前": 0.8 },
  "七浦": { "那珂町": 1.6 },
  "那珂町": { "宇多野": 2.2 },
  "宇多野": { "伊奈崎": 1.8 },
  "伊奈崎": { "鶴宮神社": 1.5 },
  "鶴宮神社": { "鶴宮": 1.2 },
  "鶴宮": { "北鶴宮": 1.1, "南鶴宮": 1.7 },
  "新里大学前": { "綾原": 0.7 },
  "綾原": { "福来": 1.2 },
  "福来": { "燠野": 1.4 },
  "燠野": { "湯川": 2.6, "紅葉台": 1.1 },
  "湯川": { "温泉口": 1.6 },
  "温泉口": { "燠野温泉": 1.9 },
  "南鶴宮": { "あずさ台": 1.4 },
  "あずさ台": { "橘町": 1.8 },
  "橘町": { "燠野山口": 1.1 },
  "燠野山口": { "白枝": 1.2 },
  "白枝": { "燠野": 1.1 },
  "紅葉台": { "桐山": 0.8 },
  "桐山": { "湊川": 0.8 },
  "湊川": { "彩山親水公園": 1.1 },
  "彩山親水公園": { "彩山": 1.2 },
  "彩山": { "蓮華寺": 0.8, "彩山口": 2.1 },
  "蓮華寺": { "星宮": 1.1 },
  "星宮": { "田ノ原": 1.1 },
  "南新里": { "田ノ原": 2.3 },
  "田ノ原": { "北玖川": 2.4 },
  "北玖川": { "玖川": 3.1 },
  "玖川": { "中野原": 3.1 },
  "彩山口": { "新里国際スキー場": 3.4 },
  "新里国際スキー場": { "鷹見台": 10.7 },
  "鷹見台": { "久我原": 2.7 },
  "久我原": { "浪原": 1.5 },
  "浪原": { "深江": 1.4 },
  "深江": { "三栗谷": 1.3 },
  "三栗谷": { "桜川公園": 1.5 },
  "桜川公園": { "桜川": 2.2 }
};

// 出発駅から到着駅までの経路探索（単純DFS）
function findPath(start, goal, visited = new Set()) {
  if (start === goal) return [start];
  visited.add(start);
  for (let neighbor in stationDistances[start] || {}) {
    if (!visited.has(neighbor)) {
      const path = findPath(neighbor, goal, visited);
      if (path) return [start, ...path];
    }
  }
  return null;
}

// 駅表示コンポーネント
const Station = ({ name, lineColor, isTerminal, isIntermediate }) => (
  <div className="flex flex-col items-start">
    <div className="flex items-center">
      <div
        className="rounded-full"
        style={{
          backgroundColor: lineColor,
          width: isIntermediate ? "12px" : "16px",
          height: isIntermediate ? "12px" : "16px"
        }}
      />
      <span className="ml-2 text-sm">{name}</span>
    </div>
    {!isIntermediate && <div className="ml-2 text-xs text-gray-600">燠野線</div>}
  </div>
);

export default function App() {
  const [showIntermediates, setShowIntermediates] = useState(false);

  const start = "豊町";
  const goal = "桜川";
  const path = findPath(start, goal) || [];

  const intermediates = path.slice(1, -1);

  return (
    <div className="p-6 font-sans">
      {/* 出発駅 */}
      <Station name={start} lineColor="#07b5f7" isTerminal={true} />
      {/* ボタンは出発駅の直後に */}
      <button
        className="ml-6 mt-1 mb-2 text-xs px-2 py-1 bg-gray-200 rounded"
        onClick={() => setShowIntermediates(!showIntermediates)}
      >
        {showIntermediates ? "途中駅を隠す" : "途中駅を表示"}
      </button>

      {/* 縦線 */}
      <div className="ml-3 border-l-2 border-[#07b5f7] h-4"></div>

      {/* 途中駅 */}
      {showIntermediates &&
        intermediates.map((st, idx) => (
          <React.Fragment key={idx}>
            <Station name={st} lineColor="#07b5f7" isIntermediate={true} />
            <div className="ml-3 border-l-2 border-[#07b5f7] h-4"></div>
          </React.Fragment>
        ))}

      {/* 到着駅 */}
      <Station name={goal} lineColor="#07b5f7" isTerminal={true} />
    </div>
  );
}
